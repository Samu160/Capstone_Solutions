<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Information Intake - Triad Energy</title>
    <link rel="stylesheet" href="./intakestyle.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöõ Client Information Intake</h1>
            <p>Please complete this form and upload required documents</p>
        </div>

        <div class="form-content">
            <div class="lang-toggle-container">
                <button class="lang-btn active" onclick="setLanguage('en')">English</button>
                <button class="lang-btn" onclick="setLanguage('es')">Espa√±ol</button>
            </div>

            <div class="success-message" id="successMessage">
                ‚úì Your information has been submitted successfully! We will contact you soon.
            </div>

            <div class="error-message" id="errorMessage">
                ‚úó There was an error submitting your information. Please try again.
            </div>

            <form id="intakeForm">
                <!-- Personal Information -->
                <div class="form-section">
                    <h2 data-en="Personal Information" data-es="Informaci√≥n Personal">Personal Information</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label data-en="First Name" data-es="Nombre"><span class="required">*</span> First Name</label>
                            <input type="text" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label data-en="Last Name" data-es="Apellido"><span class="required">*</span> Last Name</label>
                            <input type="text" name="lastName" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label data-en="Email Address" data-es="Correo Electr√≥nico"><span class="required">*</span> Email Address</label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label data-en="Phone Number" data-es="N√∫mero de Tel√©fono"><span class="required">*</span> Phone Number</label>
                            <input type="tel" name="phone" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label data-en="Date of Birth" data-es="Fecha de Nacimiento">Date of Birth</label>
                        <input type="date" name="dob">
                    </div>

                    <div class="form-group">
                        <label data-en="Address" data-es="Direcci√≥n">Address</label>
                        <input type="text" name="address" placeholder="Street Address">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label data-en="City" data-es="Ciudad">City</label>
                            <input type="text" name="city">
                        </div>
                        <div class="form-group">
                            <label data-en="State" data-es="Estado">State</label>
                            <input type="text" name="state">
                        </div>
                    </div>

                    <div class="form-group">
                        <label data-en="ZIP Code" data-es="C√≥digo Postal">ZIP Code</label>
                        <input type="text" name="zip">
                    </div>
                </div>

                <!-- Business Information -->
                <div class="form-section">
                    <h2 data-en="Business Information" data-es="Informaci√≥n del Negocio">Business Information</h2>
                    
                    <div class="form-group">
                        <label data-en="Desired Business Name" data-es="Nombre Deseado del Negocio">Desired Business Name</label>
                        <input type="text" name="businessName">
                    </div>

                    <div class="form-group">
                        <label data-en="Service Needed" data-es="Servicio Necesario"><span class="required">*</span> Service Needed</label>
                        <select name="serviceNeeded" required>
                            <option value="">Select a service...</option>
                            <option value="llc">LLC Formation</option>
                            <option value="dmv">DMV Navigation</option>
                            <option value="tax">Tax Preparation</option>
                            <option value="documentation">Documentation Support</option>
                            <option value="multiple">Multiple Services</option>
                            <option value="consultation">General Consultation</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label data-en="Additional Information / Questions" data-es="Informaci√≥n Adicional / Preguntas">Additional Information / Questions</label>
                        <textarea name="additionalInfo" placeholder="Please provide any additional details or questions..."></textarea>
                    </div>
                </div>

                <!-- Document Upload Section -->
                <div class="form-section">
                    <h2 data-en="Document Upload" data-es="Subir Documentos">Document Upload</h2>
                    <p style="color: #666; margin-bottom: 1rem;" data-en="Please upload any relevant documents (ID, tax forms, business documents, etc.)" data-es="Por favor suba cualquier documento relevante (ID, formularios de impuestos, documentos comerciales, etc.)">
                        Please upload any relevant documents (ID, tax forms, business documents, etc.)
                    </p>

                    <div class="upload-section">
                        <div class="upload-options">
                            <label for="fileInput" class="upload-btn">
                                <div class="upload-btn-icon">üìÅ</div>
                                <div class="upload-btn-text" data-en="Choose Files" data-es="Elegir Archivos">Choose Files</div>
                            </label>
                            <input type="file" id="fileInput" multiple accept="image/*,.pdf,.doc,.docx">

                            <div class="upload-btn" onclick="startCamera()">
                                <div class="upload-btn-icon">üì∑</div>
                                <div class="upload-btn-text" data-en="Take Photo" data-es="Tomar Foto">Take Photo</div>
                            </div>

                            <label for="scanInput" class="upload-btn">
                                <div class="upload-btn-icon">üìÑ</div>
                                <div class="upload-btn-text" data-en="Scan Document" data-es="Escanear Documento">Scan Document</div>
                            </label>
                            <input type="file" id="scanInput" accept="image/*" capture="environment">
                        </div>

                        <video id="cameraPreview" autoplay playsinline></video>
                        <div class="camera-controls" id="cameraControls">
                            <button type="button" onclick="capturePhoto()">üì∏ Capture</button>
                            <button type="button" onclick="stopCamera()">‚ùå Cancel</button>
                        </div>

                        <div class="uploaded-files" id="uploadedFiles"></div>
                    </div>
                </div>

                <button type="submit" class="submit-btn" data-en="Submit Information" data-es="Enviar Informaci√≥n">Submit Information</button>
            </form>
        </div>
    </div>

    <script>
        let uploadedFiles = [];
        let cameraStream = null;
        let currentLanguage = 'en';

        // Language Toggle
        function setLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('[data-en]').forEach(el => {
                el.textContent = el.getAttribute('data-' + lang);
            });
        }

        // File Input Handler
        document.getElementById('fileInput').addEventListener('change', function(e) {
            handleFiles(e.target.files);
        });

        document.getElementById('scanInput').addEventListener('change', function(e) {
            handleFiles(e.target.files);
        });

        function handleFiles(files) {
            for (let file of files) {
                uploadedFiles.push(file);
            }
            displayUploadedFiles();
        }

        // Camera Functions
        async function startCamera() {
            try {
                const preview = document.getElementById('cameraPreview');
                const controls = document.getElementById('cameraControls');
                
                cameraStream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment' } 
                });
                
                preview.srcObject = cameraStream;
                preview.style.display = 'block';
                controls.style.display = 'block';
            } catch (err) {
                alert('Unable to access camera: ' + err.message);
            }
        }

        function capturePhoto() {
            const preview = document.getElementById('cameraPreview');
            const canvas = document.createElement('canvas');
            canvas.width = preview.videoWidth;
            canvas.height = preview.videoHeight;
            canvas.getContext('2d').drawImage(preview, 0, 0);
            
            canvas.toBlob(blob => {
                const file = new File([blob], `photo_${Date.now()}.jpg`, { type: 'image/jpeg' });
                uploadedFiles.push(file);
                displayUploadedFiles();
                stopCamera();
            }, 'image/jpeg');
        }

        function stopCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            document.getElementById('cameraPreview').style.display = 'none';
            document.getElementById('cameraControls').style.display = 'none';
        }

        function displayUploadedFiles() {
            const container = document.getElementById('uploadedFiles');
            container.innerHTML = '<h3 style="margin-bottom: 0.5rem;">Uploaded Files:</h3>';
            
            uploadedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-info">
                        <span class="file-icon">${getFileIcon(file.type)}</span>
                        <span>${file.name}</span>
                    </div>
                    <button type="button" class="remove-file" onclick="removeFile(${index})">Remove</button>
                `;
                container.appendChild(fileItem);
            });
        }

        function getFileIcon(type) {
            if (type.includes('image')) return 'üñºÔ∏è';
            if (type.includes('pdf')) return 'üìï';
            if (type.includes('document') || type.includes('word')) return 'üìÑ';
            return 'üìé';
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            displayUploadedFiles();
        }

        // Form Submission
        document.getElementById('intakeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.querySelector('.submit-btn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Sending...';

            const formData = new FormData(this);
            
            // Add files to form data
            uploadedFiles.forEach((file, index) => {
                formData.append(`file${index}`, file);
            });

            try {
                // Replace Email!!!
                const response = await fetch('https://formsubmit.co/YOUR_EMAIL_HERE@example.com', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (response.ok) {
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('intakeForm').reset();
                    uploadedFiles = [];
                    displayUploadedFiles();
                    
                    setTimeout(() => {
                        document.getElementById('successMessage').style.display = 'none';
                    }, 5000);
                } else {
                    throw new Error('Submission failed');
                }
            } catch (error) {
                document.getElementById('errorMessage').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('errorMessage').style.display = 'none';
                }, 5000);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = currentLanguage === 'en' ? 'Submit Information' : 'Enviar Informaci√≥n';
            }
        });
    </script>
</body>
</html>